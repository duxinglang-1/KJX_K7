/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE.
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*****************************************************************************
 *
 * Filename:
 * ---------
 * gui_status_icons_oem.c
 *
 * Project:
 * --------
 *   MAUI
 *
 * Description:
 * ------------
 *   This file is intends for status icon bars control.
 *
 * Author:
 * -------
 * -------
 *
 *============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *============================================================================
 ****************************************************************************/

/*****************************************************************************
 *  Include
 ****************************************************************************/
#include "gui_status_icon_bar_pre_oem.h"
#include "gui_status_icon.h"
#include "gui_status_icon_bar_post_oem.h"
#include "wgui_status_icon_bar.h" /* for arrange fucntion */

#include "MMIDataType.h"
#include "gui_status_icon_bar.h"
#include "CustThemesRes.h"
#include "CustVenusThemeRes.h"
#include "gdi_include.h"
#include "gui_themes.h"
#include "wgui_categories_util.h"
#include "wgui.h"
#include "gui_typedef.h"
#include "gui.h"
#include "kal_general_types.h"
#include "gui_config.h"
#include "gui_switch.h"
#include "gdi_const.h"
#include "mmi_rp_srv_status_icons_def.h"
#include "gdi_image_alpha_bmp_v2.h"

extern S32 MAIN_LCD_device_width;

extern gui_status_icon_bar_icon_struct wgui_status_icon_bar_icons[];
extern gui_status_icon_bar_element_struct wgui_status_icon_bar_elements[];
extern gui_status_icon_bar_struct wgui_status_icon_bar_bars[];

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
static MMI_BOOL element_hide_icon = MMI_FALSE;
#endif
extern MMI_BOOL g_wgui_status_icon_bar_warning_mode;

/*****************************************************************************
 *  Local function
 ****************************************************************************/


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_sublcd_horizontal_background
 * DESCRIPTION
 *  Show the sublcd status icon bar's background
 * PARAMETERS
 *  x1          [IN]    The x coordinate of left-top corner
 *  y1          [IN]    The y coordinate of left-top corner
 *  x2          [IN]    The x coordinate of right-bottom corner
 *  y2          [IN]    The y coordinate of right-bottom corner
 * RETURNS
 *  void
 *****************************************************************************/
#ifdef __MMI_SUBLCD__
void gui_status_icon_bar_show_sublcd_horizontal_background_oem(S32 x1, S32 y1, S32 x2, S32 y2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    gdi_color c;
#endif /* __MMI_SUBLCD__ */

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#if defined(__MMI_SUBLCD__)
    #if (defined (__MMI_SUBLCD_COLOR__ ) && defined(__MMI_KLG__))
        c = gdi_act_color_from_rgb(0xff, 0, 0, 0);
    #else
        c = gdi_act_color_from_rgb(0xff,255, 255, 255);
    #endif /* (defined (__MMI_SUBLCD_COLOR__ ) && defined(__MMI_KLG__)) */

    gdi_layer_push_clip();
    gdi_layer_set_clip(x1, y1, x2, y2);
    gdi_draw_solid_rect(x1, y1, x2, y2, c);
    gdi_layer_pop_clip();
}
#endif

/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_mainlcd_horizontal_background_oem
 * DESCRIPTION
 *  Show main lcd horizontal status icon bar background
 * PARAMETERS
 *  x1          [IN]        The x coordinate of left-top corner
 *  y1          [IN]        The y coordinate of left-top corner
 *  x2          [IN]        The x coordinate of right-bottom corner
 *  y2          [IN]        The y coordinate of right-bottom corner
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_show_mainlcd_horizontal_background_oem(S32 x1, S32 y1, S32 x2, S32 y2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    UI_filled_area *f;
#endif
#ifdef __MMI_OP11_HOMESCREEN__
/* under construction !*/
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
	gui_status_icon_bar_struct *bar;
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    gdi_layer_push_and_set_clip(x1, y1, x2, y2);
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__    
    f = current_MMI_theme->status_icon_bar_filler;
#endif

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_TRANSPARENT);    
    if (bar->bar_id)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)bar->bar_id));
    }
    else if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_STYLE)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_SPECIAL_BKG));
    }
    else if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_TRANSPARENT_STYLE)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_SPECIAL_TRANSPARENT_BKG));
    }
    else
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_BKG));
    }
#elif defined(__MMI_OP11_HOMESCREEN__)
/* under construction !*/
/* under construction !*/
#else /* __MMI_OP11_HOMESCREEN__ */
    if (wgui_is_wallpaper_on_bottom())
    {
        gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_TRANSPARENT);
    }
    else
    {
        gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_WHITE);
    }

    if ((f != NULL) && !(wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR].flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_DISABLE_BACKGROUND))
    {
        gui_draw_filled_area(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, f);
    }
#endif /* __MMI_OP11_HOMESCREEN__ */
    gdi_layer_pop_clip();
}

#if (defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_mainlcd_horizontal_background_oem
 * DESCRIPTION
 *  Show main lcd horizontal status icon bar background
 * PARAMETERS
 *  x1          [IN]        The x coordinate of left-top corner
 *  y1          [IN]        The y coordinate of left-top corner
 *  x2          [IN]        The x coordinate of right-bottom corner
 *  y2          [IN]        The y coordinate of right-bottom corner
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_show_mainlcd_horizontal_background_oem_ex(S32 x1, S32 y1, S32 x2, S32 y2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
        UI_filled_area *f;
#endif
#ifdef __MMI_OP11_HOMESCREEN__
/* under construction !*/
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
        gui_status_icon_bar_struct *bar;
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/

#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__    
    f = current_MMI_theme->status_icon_bar_filler;
#endif

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_TRANSPARENT);    
    if (bar->bar_id)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)bar->bar_id));
    }
    else if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_STYLE)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_SPECIAL_BKG));
    }
    else if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_TRANSPARENT_STYLE)
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_SPECIAL_TRANSPARENT_BKG));
    }
    else
    {
        gdi_image_draw_resized(0, 0, MAIN_LCD_device_width, MMI_status_bar_height, get_image((MMI_ID_TYPE)WGUI_IMG_STATUS_BAR_BKG));
    }
#elif defined(__MMI_OP11_HOMESCREEN__)
/* under construction !*/
/* under construction !*/
#else /* __MMI_OP11_HOMESCREEN__ */
    if (wgui_is_wallpaper_on_bottom())
    {
        gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_TRANSPARENT);
    }
    else
    {
        gdi_draw_solid_rect(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, GDI_COLOR_WHITE);
    }

    if ((f != NULL) && !(wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR].flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_DISABLE_BACKGROUND))
    {
        gui_draw_filled_area(0, 0, MAIN_LCD_device_width - 1, MMI_status_bar_height - 1, f);
    }
#endif /* __MMI_OP11_HOMESCREEN__ */

}
#endif /* defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__) */

/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_mainlcd_vertical_background_oem
 * DESCRIPTION
 *  Arrange the status icon bar
 * PARAMETERS
 *
 * RETURNS
 *  void
 *****************************************************************************/
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
#ifdef WGUI_STATUS_ICON_SHOW_V_BAR
static void gui_status_icon_bar_show_mainlcd_vertical_background_oem(S32 x1, S32 y1, S32 x2, S32 y2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    UI_filled_area *f = current_MMI_theme->network_screen_background_filler;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    gdi_layer_push_clip();
    gdi_layer_set_clip(x1, y1, x2, y2);
    gui_draw_filled_area(0, 0, UI_device_width - 1, UI_device_height - 1, f);
    gdi_layer_pop_clip();
}
#endif
#endif
/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_search_next_icon
 * DESCRIPTION
 *  Accord to current display icon to search next should be shown icon
 * PARAMETERS
 *  current_icon     [IN]             The current should be shown icon
 * RETURNS
 *  The next show icon's id
 *****************************************************************************/
static S32 gui_status_icon_bar_search_next_icon(S32 current_icon)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    S32 next_icon = STATUS_ICON_INVALID_ID;
    S32 end_icon;
    S32 i;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
    if (current_icon >= STATUS_ICON_MAINLCD_RIGHT_REGION_START && current_icon < STATUS_ICON_MAINLCD_RIGHT_REGION_END)
    {
        end_icon = STATUS_ICON_MAINLCD_RIGHT_REGION_END;
    }
    else if (current_icon >= STATUS_ICON_MAINLCD_LEFT_REGION_START && current_icon < STATUS_ICON_MAINLCD_LEFT_REGION_END)
    {
        end_icon = STATUS_ICON_MAINLCD_LEFT_REGION_END;
    }
#else /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
    if (current_icon >= STATUS_ICON_MAINLCD_START && current_icon < STATUS_ICON_MAINLCD_END)
    {
        end_icon = STATUS_ICON_MAINLCD_END;
    }
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
#ifdef __MMI_SUBLCD__
    else if (current_icon >= STATUS_ICON_SUBLCD_START && current_icon < STATUS_ICON_SUBLCD_END)
    {
        end_icon = STATUS_ICON_SUBLCD_END;
    }
#endif    
    else
    {
        return STATUS_ICON_INVALID_ID;
    }

    for (i = current_icon + 1; i < end_icon; i++)
    {
        if (GUI_STATUS_ICON_BAR_ICON_DISPLAY_ON(wgui_status_icon_bar_icons[i].flags))
        {
            if (wgui_status_icon_bar_icons[i].group == GUI_STATUS_ICON_BAR_ICON_NO_GROUP)
            {
                next_icon = i;
                break;
            }
            else if (wgui_status_icon_bar_icons[i].group != wgui_status_icon_bar_icons[current_icon].group)
            {
                next_icon = i;
                break;
            }
            else
            {
                continue;
            }
        }
    }

    return next_icon;
}


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_arrange_element_preview_icon
 * DESCRIPTION
 *  Arrange the element before arrange the status icon
 * PARAMETERS
 *  bar_id     [IN]             The id of status icon bar
 * RETURNS
 *  void
 *****************************************************************************/
#ifdef  WGUI_STATUS_ICON_SHOW_ELEMENT
static void gui_status_icon_bar_arrange_element_preview_icon(wgui_status_icon_bar_enum bar_id, S32 *x1, S32 *x2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    gui_status_icon_bar_struct *bar;
    gui_status_icon_bar_element_struct *element;
    S32 temp_x1, temp_x2;
    S32 i;
    S32 gap;
    S32 float_element_width;
    MMI_BOOL bar_baseline;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#if (STATUS_ICONS_DRAW_FROM_BOTTOM_BASELINE)
    bar_baseline = MMI_TRUE;
#else
    bar_baseline = MMI_FALSE;
#endif  

    bar = &wgui_status_icon_bar_bars[bar_id];
    gap = STATUS_ICON_X_GAP;
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
    temp_x1 = MMI_UI_STATUSBAR_GAP;
    temp_x2 = *x2;

#else /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
    temp_x1 = *x1;
    temp_x2 = wgui_status_icon_bar_icons[STATUS_ICON_BATTERY_STRENGTH].x - gap;
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
    float_element_width = 0;
    
    for (i = 0; i < bar->n_elements; i++)
    {
        element = &wgui_status_icon_bar_elements[bar->element_list[i]];
        if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_ALIGN_LEFT)
        {
            element->x = temp_x1;
            temp_x1 += element->width - 1 + gap;
        }
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
        else if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_ALIGN_RIGHT)
        {
            element->x = bar->width - element->width + 1 - MMI_UI_STATUSBAR_GAP * 2;
        }
        else if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_FLOAT)
        {
            float_element_width += element->width + gap;
        }
#else /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */        
        else if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_FLOAT)
        {
            float_element_width += element->width + gap;
        }
        else if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_ALIGN_RIGHT)
        {
            element->x = temp_x2 - element->width + 1;
            temp_x2 = element->x - gap;
        }
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

        if (bar_baseline)
        {
            element->y = bar->height - element->height;
        }
        else
        {
            element->y = (bar->height - element->height) >> 1;
        }
    }

    if (float_element_width > 0)
    {
        if (bar->flags & WGUI_STATUS_ICON_BAR_ALIGN_BAR_RIGHT)
        {
            temp_x1 += float_element_width;
        }
        else
        {
            temp_x2 -= float_element_width;
        }
    }

    *x1 = temp_x1;
    *x2 = temp_x2;
}


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_adjust_float_element
 * DESCRIPTION
 *  Adjust the float element's coordinate after arrange status icon
 * PARAMETERS
 *  bar_id     [IN]             The id of status icon bar
 *  x1         [OUT]
 *  x2         [OUT]
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_adjust_float_element(wgui_status_icon_bar_enum bar_id, S32 *x1, S32 *x2)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    S32 x = 0;
    gui_status_icon_bar_struct *bar;
    gui_status_icon_bar_element_struct *element;
    S32 i;
    S32 gap;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    bar = &wgui_status_icon_bar_bars[bar_id];
    gap = STATUS_ICON_X_GAP;
    
    if (bar->flags & WGUI_STATUS_ICON_BAR_ALIGN_BAR_RIGHT)
    {
        x = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons - 1]].x - gap;
        for (i = 0; i < bar->n_elements; i++)
        {
            element = &wgui_status_icon_bar_elements[bar->element_list[i]];
            if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_FLOAT)
            {
                element->x = x - element->width + 1;
                x = element->x - gap;
            }
        }
        *x2 = x;
    }
    else
    {
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
        if(bar->n_all_events)
        {
            x = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons - 1]].x + wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons - 1]].width + gap;
        }
        else
        {
            x = gap;
        }
#else
#if (defined(__MMI_DUAL_SIM_MASTER__) || (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2))) && \
 (defined(__OP02__) || defined(__OP01__)) &&  \
 (defined(__GSM_RAT__) && (defined(__UMTS_RAT__) || defined(__OP01_3G__)))
        /* for qvga project if show ime indicator the last icon is STATUS_ICON_SLAVE_2G */
        if(bar->icon_list[bar->n_icons - 1] == STATUS_ICON_SLAVE_2G)
        {
            x = wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x + wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].width - 1 + gap;
        }
        else
#endif
        {
            x = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons - 1]].x + wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons - 1]].width - 1 + gap;
        }

#endif
        for (i = 0; i < bar->n_elements; i++)
        {
            element = &wgui_status_icon_bar_elements[bar->element_list[i]];
            if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_FLOAT)
            {
                element->x = x;
                x += element->width + gap;
            }
        }
        *x1 = x;
    }
}

#endif /* #ifdef  WGUI_STATUS_ICON_SHOW_ELEMENT */ 

/*****************************************************************************
 *  Global function
 ****************************************************************************/


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_arrange_oem
 * DESCRIPTION
 *  Arrange the status icon bar
 * PARAMETERS
 *
 * RETURNS
 *  void
 *****************************************************************************/
void gui_status_icon_bar_arrange_oem(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    S32 x1, x2, x;
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    S32 y1, y2, y;
    MMI_BOOL bar_top_align;
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
    S32 right_icon_id = STATUS_ICON_INVALID_ID;
    S32 x2_temp, x2_temp_2;
    MMI_BOOL right_need_borrow = MMI_FALSE, left_can_lend = MMI_TRUE;
#endif
    S32 i;
    S32 icon_id;
    gui_status_icon_bar_struct *bar;
    gui_status_icon_bar_icon_struct *icon;
    MMI_BOOL bar_baseline;
#if (!defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) && defined(__MMI_FTE_SUPPORT__) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
    MMI_BOOL need_reserve = MMI_FALSE;
    S32 new_icon_id = 0;
    S32 temp_icon_id;
    S32 last_sig_icon_id;
#endif
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#if (STATUS_ICONS_DRAW_FROM_BOTTOM_BASELINE)
    bar_baseline = MMI_TRUE;
#else
    bar_baseline = MMI_FALSE;
#endif 

    /* MainLCD horizontal status icon bar */

    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    bar->icon_list[0] = STATUS_ICON_SIGNAL_STRENGTH;
    bar->icon_list[1] = STATUS_ICON_BATTERY_STRENGTH;
    bar->n_icons = 2;
    x1 = MMI_UI_STATUSBAR_GAP;
    x2 = bar->width - 1 - MMI_UI_STATUSBAR_GAP;

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
    if (wgui_status_icon_bar_elements[0].flag & WGUI_STATUS_ICON_BAR_ELEMENT_ALIGN_RIGHT)
    {
        x2 -= wgui_status_icon_bar_elements[0].width + MMI_UI_STATUSBAR_GAP * 2;
    }
    if (!(wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[0] = STATUS_ICON_BATTERY_STRENGTH;
        bar->n_icons = 1;
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[0]].width + 1 - STATUS_ICON_X_GAP;
        x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;
    }
    else
    {
        wgui_status_icon_bar_icons[bar->icon_list[1]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[1]].width + 1 - STATUS_ICON_X_GAP;
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[1]].width - wgui_status_icon_bar_icons[bar->icon_list[0]].width + 1 - STATUS_ICON_X_GAP;
        x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;
        //icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_BATTERY_STRENGTH);
    }

    #if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 4))
    if (wgui_status_icon_bar_icons[STATUS_ICON_SIM4_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SIM4_SIGNAL_STRENGTH;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons-1]].x - wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].width - STATUS_ICON_X_GAP;
        
        if (bar->icon_list[0] == STATUS_ICON_SIGNAL_STRENGTH)
        {
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - wgui_status_icon_bar_icons[bar->icon_list[0]].width - STATUS_ICON_X_GAP;    
        
        x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;
        }
        else
        {
            x2 = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - STATUS_ICON_X_GAP;
        }
        bar->n_icons ++;
    }
    #endif /* MMI_MAX_SIM_NUM >= 4 */

    #if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
    if (wgui_status_icon_bar_icons[STATUS_ICON_SIM3_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SIM3_SIGNAL_STRENGTH;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons-1]].x - wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].width - STATUS_ICON_X_GAP;
        
        if (bar->icon_list[0] == STATUS_ICON_SIGNAL_STRENGTH)
        {
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - wgui_status_icon_bar_icons[bar->icon_list[0]].width - STATUS_ICON_X_GAP;    
        
        x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;
        }
        else
        {
            x2 = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - STATUS_ICON_X_GAP;
        }
        bar->n_icons ++;
        
    }
    #endif /* MMI_MAX_SIM_NUM >= 3 */

    #if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2))
    if (wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SLAVE_SIGNAL_STRENGTH;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons-1]].x - wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].width - STATUS_ICON_X_GAP;
        
        if (bar->icon_list[0] == STATUS_ICON_SIGNAL_STRENGTH)
        {
            wgui_status_icon_bar_icons[bar->icon_list[0]].x = 
                wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - wgui_status_icon_bar_icons[bar->icon_list[0]].width - STATUS_ICON_X_GAP;    
            
            x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;
        }
        else
        {
            x2 = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - STATUS_ICON_X_GAP;
        }
        bar->n_icons ++;
    }
    #endif /* MMI_MAX_SIM_NUM >= 2 */

#if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM == 4))
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SIM4_SIGNAL_STRENGTH);
#elif (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM == 3))
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SIM3_SIGNAL_STRENGTH);
#elif (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM == 2))
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SLAVE_SIGNAL_STRENGTH);

#if defined(__OP02__)
#if defined(__GSM_RAT__) && (defined(__UMTS_RAT__) || defined(__OP01_3G__))
    if (wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_2G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SLAVE_2G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x;

        wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - 
            wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].width - STATUS_ICON_X_GAP;
        
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = 
            wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - wgui_status_icon_bar_icons[bar->icon_list[0]].width - STATUS_ICON_X_GAP;    
        
        x2 = wgui_status_icon_bar_icons[bar->icon_list[0]].x - STATUS_ICON_X_GAP;

        bar->n_icons ++;
    }
    if (wgui_status_icon_bar_icons[STATUS_ICON_3G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_3G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x - 
            wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].width - STATUS_ICON_X_GAP;
        
        x2 = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - STATUS_ICON_X_GAP;
        
        bar->n_icons ++;
    }
    else if (wgui_status_icon_bar_icons[STATUS_ICON_2G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_2G;
    
       wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x - 
            wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].width - STATUS_ICON_X_GAP;
        
        x2 = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x - STATUS_ICON_X_GAP;
        
        bar->n_icons ++;
    }
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SLAVE_2G);
#endif
#endif /* __OP02__*/
#else /* 2 SIM */
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_BATTERY_STRENGTH);
#endif

#else /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
    if(!(wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[0] = bar->icon_list[1];
        bar->n_icons = 1;
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[1]].width + 1;
    }
    else
    {
        wgui_status_icon_bar_icons[bar->icon_list[0]].x = x1;
        wgui_status_icon_bar_icons[bar->icon_list[1]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[1]].width + 1;
        x1 += wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].width + STATUS_ICON_X_GAP;
    }

#if ((!defined(__MMI_FTE_SUPPORT__)) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))

    /* Non-FTE(Multi SIM) project */

    #if (MMI_MAX_SIM_NUM >= 4)     
    wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x;
    wgui_status_icon_bar_icons[STATUS_ICON_SIM3_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x;
    wgui_status_icon_bar_icons[STATUS_ICON_SIM4_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x;
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SIM4_SIGNAL_STRENGTH);
    #elif (MMI_MAX_SIM_NUM >= 3) 
    wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x;
    wgui_status_icon_bar_icons[STATUS_ICON_SIM3_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x;
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SIM3_SIGNAL_STRENGTH);
    #endif

#else

    /* FTE, Non-FTE(Dual SIM, Single SIM) project */

    #if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2))
    if(wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SLAVE_SIGNAL_STRENGTH;
        if(wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
        {
            wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x = wgui_status_icon_bar_icons[0].x + 
                    wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].width + STATUS_ICON_X_GAP;
        }
        else
        {
            wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x = STATUS_ICON_X_GAP;
        }

        icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SLAVE_SIGNAL_STRENGTH);
        x1 += wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].width + STATUS_ICON_X_GAP;
        bar->n_icons ++;
    }
    else
    {
        icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_BATTERY_STRENGTH);
    }
    #else
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_BATTERY_STRENGTH);
    #endif
#endif /* (!defined(__MMI_FTE_SUPPORT__)) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3) */

#if (defined(__MMI_DUAL_SIM_MASTER__) || (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2)))
#if defined(__OP02__) || defined(__OP01__)
#if defined(__GSM_RAT__) && (defined(__UMTS_RAT__) || defined(__OP01_3G__))    
#if (defined(__HSDPA_SUPPORT__) || defined(__HSUPA_SUPPORT__))    
    if ((wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY) && 
            (wgui_status_icon_bar_icons[STATUS_ICON_35G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_35G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x;
        wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_35G].width + STATUS_ICON_X_GAP;
        wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_35G].width + STATUS_ICON_X_GAP;

        x1 += wgui_status_icon_bar_icons[STATUS_ICON_35G].width + STATUS_ICON_X_GAP;

        bar->n_icons ++;
    }
    else
#endif
    {
    if ((wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY) && 
            (wgui_status_icon_bar_icons[STATUS_ICON_3G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_3G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x;
        wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_3G].width + STATUS_ICON_X_GAP;
        wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_3G].width + STATUS_ICON_X_GAP;

        x1 += wgui_status_icon_bar_icons[STATUS_ICON_3G].width + STATUS_ICON_X_GAP;

        bar->n_icons ++;
    }
    else if((wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY) &&  
                (wgui_status_icon_bar_icons[STATUS_ICON_2G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_2G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x;
        wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_2G].width + STATUS_ICON_X_GAP;
        wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x =  wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_2G].width + STATUS_ICON_X_GAP;
        
        x1 += wgui_status_icon_bar_icons[STATUS_ICON_2G].width + STATUS_ICON_X_GAP;
        
        bar->n_icons ++;
    }
    } 
    if ((wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY) &&  
            (wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_2G].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY))
    {
        bar->icon_list[bar->n_icons] = STATUS_ICON_SLAVE_2G;
    
        wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons]].x = wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x;

        wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x =   wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].x + 
            wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_2G].width + STATUS_ICON_X_GAP;
        
        
        x1 += wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_2G].width + STATUS_ICON_X_GAP;
      
        bar->n_icons ++;
    }
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SLAVE_2G);
#endif
#endif /* __OP02__ || __OP01__ */
#endif /* defined(__MMI_DUAL_SIM_MASTER__) || (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2)) */

#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__ 
    while (icon_id != STATUS_ICON_MAINLCD_RIGHT_REGION_END && icon_id != STATUS_ICON_INVALID_ID)
    {
        icon = &wgui_status_icon_bar_icons[icon_id];
        x = x2 - icon->width + 1;
        if ((!g_wgui_status_icon_bar_warning_mode) && (bar->info_state == WGUI_STATUS_ICON_BAR_EVENTS_HIDE || 
            (bar->info_state != WGUI_STATUS_ICON_BAR_INFO_HIDE && bar->info_state != WGUI_STATUS_ICON_BAR_EVENTS_HIDE && 
            bar->previous_state == WGUI_STATUS_ICON_BAR_EVENTS_HIDE)))
        {
            if (x <= 0 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
        }
        else
        {
            if (bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }

            if(x <= bar->width /2)
            {
                right_need_borrow = MMI_TRUE;
                right_icon_id = icon_id;
                break;
            }
        }
        icon->x = x;
        x2 = x - STATUS_ICON_X_GAP;

        bar->icon_list[bar->n_icons] = icon_id;
        bar->n_icons++;
        icon_id = gui_status_icon_bar_search_next_icon(icon_id);
    }
    x2_temp = x2;
    gui_status_icon_bar_arrange_element_preview_icon(
        WGUI_STATUS_ICON_BAR_H_BAR,
        &x1,
        &x2);

    if(g_wgui_status_icon_bar_warning_mode)
    {
        icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_MAINLCD_RIGHT_REGION_END);
        if(icon_id != STATUS_ICON_INVALID_ID)
        {
            element_hide_icon = MMI_TRUE;
            bar->warning_info_w = (x2 - MMI_UI_STATUSBAR_GAP + 1) - wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].width;
        }
        else
        {
            element_hide_icon = MMI_FALSE;
            bar->warning_info_w = x2 - MMI_UI_STATUSBAR_GAP + 1;
        }
    }
    else if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_HIDE || 
        (bar->info_state != WGUI_STATUS_ICON_BAR_INFO_HIDE  && bar->info_state != WGUI_STATUS_ICON_BAR_EVENTS_HIDE &&
        bar->previous_state == WGUI_STATUS_ICON_BAR_INFO_HIDE))
    {
        x2_temp_2 = x2;
        for(i = bar->n_all_events - 1; i >= 0; i--)
        {
            icon = &wgui_status_icon_bar_icons[bar->all_show_events[i]];
            
            if(i == bar->n_all_events - 1 || bar->all_show_events[i] <= STATUS_ICON_MAINLCD_HIGE_END)
            {
                x2 -= icon->width + STATUS_ICON_X_GAP;
                if(x2 < x1)
                {
                    x2 += icon->width + STATUS_ICON_X_GAP;
                    break;
                }
            }
        }
        element_hide_icon = MMI_FALSE;
        for(i = bar->n_all_events - 1; i >= 0; i--)
        {
            if(bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
            icon = &wgui_status_icon_bar_icons[bar->all_show_events[i]];
            if(i == bar->n_all_events - 1 || bar->all_show_events[i] <= STATUS_ICON_MAINLCD_HIGE_END)
            {
                x2 += icon->width + STATUS_ICON_X_GAP;
            }
            x = x1 + icon->width - 1;

            if(x > x2_temp_2)
            {
                break;
            }
            if(x > x2)
            {
                left_can_lend = MMI_FALSE;
                element_hide_icon = MMI_TRUE;
                continue;
            }
            icon->x = x1;
            x1 += icon->width + STATUS_ICON_X_GAP;

            bar->icon_list[bar->n_icons] = bar->all_show_events[i];
            bar->n_icons++;
        }
        if(element_hide_icon)
        {
            wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].x = wgui_status_icon_bar_icons[bar->icon_list[bar->n_icons-1]].x;
            wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].flags |= GUI_STATUS_ICON_BAR_ICON_DISPLAY;
            bar->icon_list[bar->n_icons-1] = STATUS_ICON_LEFT_HIDE;
        }
    }
#else /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

#ifdef  WGUI_STATUS_ICON_SHOW_ELEMENT    
    gui_status_icon_bar_arrange_element_preview_icon(
        WGUI_STATUS_ICON_BAR_H_BAR,
        &x1,
        &x2);
#endif

#ifdef __MMI_FTE_SUPPORT__
    #if defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM == 3)
        last_sig_icon_id = STATUS_ICON_SIM3_SIGNAL_STRENGTH;
    #elif defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM == 4)
        last_sig_icon_id = STATUS_ICON_SIM4_SIGNAL_STRENGTH;
    #endif

#endif /* __MMI_FTE_SUPPORT__ */

#if (defined(__MMI_FTE_SUPPORT__) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
    new_icon_id = bar->new_icon_id;
    if((new_icon_id > last_sig_icon_id) && (GUI_STATUS_ICON_BAR_ICON_DISPLAY_ON(wgui_status_icon_bar_icons[new_icon_id].flags)))
    {
        need_reserve = MMI_TRUE;
        temp_icon_id = new_icon_id - 1;
        if(wgui_status_icon_bar_icons[new_icon_id].group != GUI_STATUS_ICON_BAR_ICON_NO_GROUP)
        {
            while(wgui_status_icon_bar_icons[temp_icon_id].group == wgui_status_icon_bar_icons[new_icon_id].group)
            {
                if(GUI_STATUS_ICON_BAR_ICON_DISPLAY_ON(wgui_status_icon_bar_icons[temp_icon_id].flags))
                {
                    new_icon_id = temp_icon_id;
                }
                temp_icon_id--;
            }
        }
    }
#endif /* (defined(__MMI_FTE_SUPPORT__))defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2) */

    while (icon_id != STATUS_ICON_INVALID_ID)
    {    
        icon = &wgui_status_icon_bar_icons[icon_id];
        if (bar->flags & WGUI_STATUS_ICON_BAR_ALIGN_BAR_RIGHT)
        {
            x = x2 - icon->width + 1;
            if (x <= x1 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
            icon->x = x;
            x2 = x - STATUS_ICON_X_GAP;
        }

        if (bar->flags & WGUI_STATUS_ICON_BAR_ALIGN_BAR_RIGHT)
        {
        #if (defined(__MMI_FTE_SUPPORT__) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
            if(need_reserve && (icon_id > last_sig_icon_id))
            {
                wgui_status_icon_bar_icons[new_icon_id].x = x2 - wgui_status_icon_bar_icons[new_icon_id].width + 1;
                x2 = wgui_status_icon_bar_icons[new_icon_id].x - STATUS_ICON_X_GAP;
                need_reserve = MMI_FALSE;
                bar->icon_list[bar->n_icons] = new_icon_id;
                bar->n_icons++;
            }
            if((icon_id > last_sig_icon_id) && (icon_id == new_icon_id))
            {
                icon_id = gui_status_icon_bar_search_next_icon(icon_id);
                continue;
            }
        #endif /* (defined(__MMI_FTE_SUPPORT__))defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2) */
            x = x2 - icon->width + 1;
            if (x <= x1 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
            icon->x = x;
            x2 = x - STATUS_ICON_X_GAP;
        }
        else
        {
        #if (defined(__MMI_FTE_SUPPORT__) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
            if(need_reserve && (icon_id > last_sig_icon_id))
            {
                wgui_status_icon_bar_icons[new_icon_id].x = x1;
                x1 = x1 + wgui_status_icon_bar_icons[new_icon_id].width - 1 + STATUS_ICON_X_GAP;
                need_reserve = MMI_FALSE;
                bar->icon_list[bar->n_icons] = new_icon_id;
                bar->n_icons++;
            }
            if((icon_id > last_sig_icon_id) && (icon_id == new_icon_id))
            {
                icon_id = gui_status_icon_bar_search_next_icon(icon_id);
                continue;
            }
        #endif /* (defined(__MMI_FTE_SUPPORT__))defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 2) */
            x = x1 + icon->width - 1;
            if (x >= x2 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
            icon->x = x1;
            x1 += icon->width - 1 + STATUS_ICON_X_GAP;
        }
        bar->icon_list[bar->n_icons] = icon_id;
        bar->n_icons++;
#if ((!defined(__MMI_FTE_SUPPORT__)) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
        if (icon_id >= STATUS_ICON_FULL_SMS && icon_id <= STATUS_ICON_SIM4_FULL_SMS)
        {
            wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_FULL_SMS].x = wgui_status_icon_bar_icons[icon_id].x;
            wgui_status_icon_bar_icons[STATUS_ICON_SIM3_FULL_SMS].x = wgui_status_icon_bar_icons[icon_id].x;
            wgui_status_icon_bar_icons[STATUS_ICON_SIM4_FULL_SMS].x = wgui_status_icon_bar_icons[icon_id].x;
            icon_id = STATUS_ICON_SIM4_FULL_SMS;
        }
#endif
        icon_id = gui_status_icon_bar_search_next_icon(icon_id);
    }
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

#ifdef  WGUI_STATUS_ICON_SHOW_ELEMENT    
    gui_status_icon_bar_adjust_float_element(WGUI_STATUS_ICON_BAR_H_BAR, &x1, &x2);
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    /* Arrange right area icons in left area */
    if(right_need_borrow && left_can_lend)
    {
        icon_id = right_icon_id;
        while (icon_id != STATUS_ICON_MAINLCD_RIGHT_REGION_END && icon_id != STATUS_ICON_INVALID_ID)
        {
            if (bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_H_ICON_LIST_NUM)
            {
                break;
            }
            icon = &wgui_status_icon_bar_icons[icon_id];
            x = x2_temp - icon->width + 1;
            if(x < x1)
            {
                break;
            }
            icon->x = x;
            x2_temp = x - STATUS_ICON_X_GAP;
            bar->icon_list[bar->n_icons] = icon_id;
            bar->n_icons++;
            icon_id = gui_status_icon_bar_search_next_icon(icon_id);
        }
    }
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYPE__ */
    /* Set y coordinate for the icons arranged above */
    if (bar_baseline)
    {
        for(i = 0; i < bar->n_icons; i++)
        {
            wgui_status_icon_bar_icons[bar->icon_list[i]].y = bar->height - wgui_status_icon_bar_icons[bar->icon_list[i]].height;
        }
    }
    else
    {
        for(i = 0; i < bar->n_icons; i++)
        {
            wgui_status_icon_bar_icons[bar->icon_list[i]].y = (bar->height - wgui_status_icon_bar_icons[bar->icon_list[i]].height) >> 1;
        }
    }
#if (defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3)) && (!defined(__MMI_FTE_SUPPORT__)) && (!defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__))   
    wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_SIGNAL_STRENGTH].y = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].y;    
    wgui_status_icon_bar_icons[STATUS_ICON_SIM3_SIGNAL_STRENGTH].y = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].y;    
    wgui_status_icon_bar_icons[STATUS_ICON_SLAVE_FULL_SMS].y = wgui_status_icon_bar_icons[STATUS_ICON_FULL_SMS].y;  
    wgui_status_icon_bar_icons[STATUS_ICON_SIM3_FULL_SMS].y = wgui_status_icon_bar_icons[STATUS_ICON_FULL_SMS].y;  
#if (MMI_MAX_SIM_NUM >= 4)
    wgui_status_icon_bar_icons[STATUS_ICON_SIM4_SIGNAL_STRENGTH].y = wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH].y;    
    wgui_status_icon_bar_icons[STATUS_ICON_SIM4_FULL_SMS].y = wgui_status_icon_bar_icons[STATUS_ICON_FULL_SMS].y;  
#endif
#endif

    /* MainLCD vertical status icon bar */
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
#ifdef WGUI_STATUS_ICON_SHOW_V_BAR
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_V_BAR];
    if (wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR].y1 >= bar->y2)
    {
        bar_top_align = MMI_FALSE;
    }
    else
    {
        bar_top_align = MMI_TRUE;
    }

    y1 = STATUS_ICON_Y_GAP;
    y2 = bar->height - 1 - STATUS_ICON_Y_GAP;
    x = bar->width;
    bar->n_icons = 0;
    while (icon_id != STATUS_ICON_INVALID_ID)
    {     
#if (defined(__MMI_FTE_SUPPORT__) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
        if((icon_id > last_sig_icon_id) && (icon_id == new_icon_id))
        {
            icon_id = gui_status_icon_bar_search_next_icon(icon_id);
            continue;
        }
#endif /* (defined(__MMI_FTE_SUPPORT__))defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3) */
        icon = &wgui_status_icon_bar_icons[icon_id];
        if (bar_top_align)
        {
            y = y1 + icon->height - 1;
            if (y > y2 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_V_ICON_LIST_NUM)
            {
                break;
            }
            icon->y = y1;
            y1 = y + STATUS_ICON_Y_GAP;
        }
        else
        {
            y = y2 - icon->height - 1;
            if (y < y1 || bar->n_icons >= WGUI_STATUS_ICON_BAR_MAINLCD_V_ICON_LIST_NUM)
            {
                break;
            }
            icon->y = y;
            y2 = y - STATUS_ICON_Y_GAP;
        }

        icon->x = (x - icon->width) >> 1;
        bar->icon_list[bar->n_icons] = icon_id;
        bar->n_icons++;
        icon_id = gui_status_icon_bar_search_next_icon(icon_id);
    }
#endif /* #ifdef WGUI_STATUS_ICON_SHOW_V_BAR */

    /* SubLCD horizontal status icon bar */
#ifdef __MMI_SUBLCD__
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_SUBLCD_H_BAR];

    x1 = SUBLCD_STATUS_ICON_X_GAP;
    x2 = bar->width - 1 - SUBLCD_STATUS_ICON_X_GAP;
    if(wgui_status_icon_bar_icons[STATUS_ICON_SUBLCD_SIGNAL_STRENGTH].flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
    {
        bar->icon_list[0] = STATUS_ICON_SUBLCD_SIGNAL_STRENGTH;
        bar->icon_list[1] = STATUS_ICON_SUBLCD_BATTERY_STRENGTH;
        bar->n_icons = 2;
        wgui_status_icon_bar_icons[bar->icon_list[1]].x = x2 - wgui_status_icon_bar_icons[bar->icon_list[1]].width;
        
    }
    else
    {
        bar->icon_list[0] = STATUS_ICON_SUBLCD_BATTERY_STRENGTH;
        bar->n_icons = 1;
    }
    wgui_status_icon_bar_icons[bar->icon_list[0]].x = x1;
    x1 += wgui_status_icon_bar_icons[bar->icon_list[0]].width + SUBLCD_STATUS_ICON_X_GAP;
    x2 -= wgui_status_icon_bar_icons[STATUS_ICON_SUBLCD_BATTERY_STRENGTH].width + SUBLCD_STATUS_ICON_X_GAP;
    if (bar_baseline)
    {
        wgui_status_icon_bar_icons[bar->icon_list[0]].y = bar->height - wgui_status_icon_bar_icons[bar->icon_list[0]].height;
        wgui_status_icon_bar_icons[STATUS_ICON_SUBLCD_BATTERY_STRENGTH].y = bar->height - wgui_status_icon_bar_icons[bar->icon_list[1]].height;
    }
    else
    {
        wgui_status_icon_bar_icons[bar->icon_list[0]].y = (bar->height - wgui_status_icon_bar_icons[bar->icon_list[0]].height) >> 1;
        wgui_status_icon_bar_icons[STATUS_ICON_SUBLCD_BATTERY_STRENGTH].y = (bar->height - wgui_status_icon_bar_icons[bar->icon_list[1]].height) >> 1;
    }
    
    icon_id = gui_status_icon_bar_search_next_icon(STATUS_ICON_SUBLCD_BATTERY_STRENGTH);
    while (icon_id != STATUS_ICON_INVALID_ID)
    {
        icon = &wgui_status_icon_bar_icons[icon_id];
        x = x1 + icon->width + SUBLCD_STATUS_ICON_X_GAP;
        if (x > x2 || bar->n_icons >= WGUI_STATUS_ICON_BAR_SUBLCD_ICON_LIST_NUM)
        {
            break;
        }

        icon->x = x1;
        x1 = x;

        if (bar_baseline)
        {
            icon->y = bar->height- icon->height;
        }
        else
        {
            icon->y = (bar->height- icon->height) >> 1;
        }
        
        bar->icon_list[bar->n_icons] = icon_id;
        bar->n_icons++;
        icon_id = gui_status_icon_bar_search_next_icon(icon_id);
    }
#endif /* #ifdef __MMI_SUBLCD__*/
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
}


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_icon_oem
 * DESCRIPTION
 *  Show icon in status icon bar
 * PARAMETERS
 *  icon        [IN]        Pointer to status icon
 * RETURNS
 *  void
 *****************************************************************************/
void gui_status_icon_bar_show_icon_oem(gui_status_icon_bar_struct *bar, gui_status_icon_bar_icon_struct *icon)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    S32 icon_x, icon_y;
    S32 image_w, image_h;
    S32 offset_x, offset_y, dest_w, dest_h;
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
// baiwenlin 20130902  
#if defined(__OLED_BW_MMI__)
	return;
#endif /* __OLED_BW_MMI__ */
    icon_x = bar->x + icon->x;
    icon_y = bar->y + icon->y;
    if (icon->image_id != IMAGE_ID_NULL)
    {
    #ifdef __MMI_DOWNLOADABLE_THEMES_SUPPORT__
        if (mmi_tm_does_theme_have_alt_image())
        {
            if (mmi_tm_is_theme_dirty_bit_set(GetImageIndex((S16)icon->image_id)))
            {
                icon->image_data = get_image((S16)icon->image_id);
            }
        }
    #endif

        if (icon->flags & GUI_STATUS_ICON_BAR_ICON_ANIMATE)
        {
            gdi_image_draw_frames_blend2layers(
                icon_x,
                icon_y,
                icon->image_data,
                (U16)icon->current_frame);
        }
        else if (icon->flags & GUI_STATUS_ICON_BAR_ICON_BLINK)
        {
            if (icon->flags & GUI_STATUS_ICON_BAR_ICON_BLINK_ON)
            {
                if(icon->n_frames == 255)
                {
                    gdi_image_get_dimension(icon->image_data, &image_w, &image_h);
                    gdi_util_fit_box(
                        GDI_UTIL_MODE_SHORT_SIDE_FIT,
                        icon->width,
                        icon->height,
                        image_w,
                        image_h,
                        &offset_x,
                        &offset_y,
                        &dest_w,
                        &dest_h);
                    icon_x += offset_x;
                    icon_y += offset_y;
                    gdi_image_draw_resized_blend2layers(icon_x, icon_y, dest_w, dest_h, icon->image_data);
                }
                else
                {
                    gdi_image_draw_blend2layers(
                        icon_x,
                        icon_y,
                        icon->image_data);
                }
            }
        }
        else if (icon->flags & GUI_STATUS_ICON_BAR_ICON_DISPLAY)
        {
            if (icon->state > 0)
            {
                gdi_image_draw_frames_blend2layers(
                    icon_x,
                    icon_y,
                    icon->image_data,
                    icon->state);
            }
            else
            {
                if(icon->n_frames == 255)
                {
                    gdi_image_get_dimension(icon->image_data, &image_w, &image_h);
                    gdi_util_fit_box(
                        GDI_UTIL_MODE_SHORT_SIDE_FIT,
                        icon->width,
                        icon->height,
                        image_w,
                        image_h,
                        &offset_x,
                        &offset_y,
                        &dest_w,
                        &dest_h);
                    icon_x += offset_x;
                    icon_y += offset_y;
                    gdi_image_draw_resized_blend2layers(icon_x, icon_y, dest_w, dest_h, icon->image_data);
                }
                else
                {
                    gdi_image_draw_blend2layers(
                        icon_x,
                        icon_y,
                        icon->image_data);
                }
            }
        }
    }
}


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_hide_oem
 * DESCRIPTION
 *  Hide status icon bar, show the backgound of status icon bar
 * PARAMETERS
 *  bar       [IN]        Pointer to status icon bar struct
 * RETURNS
 *  void
 *****************************************************************************/
void gui_status_icon_bar_hide_oem(gui_status_icon_bar_struct *bar)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
// baiwenlin 20130902  
#if defined(__OLED_BW_MMI__)
	return;
#endif /* __OLED_BW_MMI__ */
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    if (bar->hide_callback)
    {
        bar->hide_callback();
    }
    else
#endif
    {
        if (bar == &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR])
        {
            gui_status_icon_bar_show_mainlcd_horizontal_background_oem(bar->x1, bar->y1, bar->x2, bar->y2);
        }
#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
#ifdef WGUI_STATUS_ICON_SHOW_V_BAR    
        else if (bar == &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_V_BAR])
        {
            gui_status_icon_bar_show_mainlcd_vertical_background_oem(bar->x1, bar->y1, bar->x2, bar->y2);
        }
#endif        
#ifdef __MMI_SUBLCD__
        else if (bar == &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_SUBLCD_H_BAR])
        {
            gui_status_icon_bar_show_sublcd_horizontal_background_oem(bar->x1, bar->y1, bar->x2, bar->y2);
        }
#endif
#endif /*#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__*/
    }
}

#if (defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
#define WGUI_STATUS_ICON_BAR_FADE_COUNT      150
/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_fade_in_hdlr 
 * DESCRIPTION
 *  Callback function to hide info in status icon bar
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_fade_in_hdlr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    gui_status_icon_bar_struct *bar;
    

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    if (bar->fade_step != WGUI_STATUS_ICON_BAR_FADE_MAX_STEP)
    {
        bar->fade_step ++;
    }
    wgui_status_icon_bar_update();

}


/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_fade_out_hdlr
 * DESCRIPTION
 *  Callback function to hide info in status icon bar
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_fade_out_hdlr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    gui_status_icon_bar_struct *bar;
    

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    wgui_status_icon_bar_update();

    bar->fade_step ++;

}



/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_info_hdlr
 * DESCRIPTION
 *  Callback function to hide info in status icon bar
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_info_hdlr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    gui_status_icon_bar_struct *bar;
    

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    bar = &wgui_status_icon_bar_bars[WGUI_STATUS_ICON_BAR_H_BAR];
    bar->info_state = WGUI_STATUS_ICON_BAR_INFO_FADE_OUT;
    wgui_status_icon_bar_update();

}

/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_info_show_info_oem
 * DESCRIPTION
 *  show info
 * PARAMETERS
 *  bar         [IN]            bar
 *  y_offset    [IN]
 * RETURNS
 *  void
 *****************************************************************************/
static void gui_status_icon_bar_show_info_oem(gui_status_icon_bar_struct *bar, S32 y_offset)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    PU8 image_data;
    U16 image_type;
    S32 x, y, w = 0, h = 0;
    S32 resized_w, resized_h, icon_box_offset_x, icon_box_offset_y;
    stFontAttribute s_font={0,0,0,0x8F,0,1};
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    S32 temp_color;
    color info_color, border_color;
#endif

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_MAINLCD_480X800__
    gui_set_font(&s_font);
#else
    gui_set_font(&MMI_small_font);
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_STYLE || bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_TRANSPARENT_STYLE ||
        bar->bar_id)
    {
        gui_set_text_color(UI_COLOR_WHITE);
        gui_set_text_border_color(UI_COLOR_BLACK);
    }
    else
    {
        temp_color = mmi_res_get_theme_color(WGUI_COL_STATUS_BAR_TEXT);
        info_color.alpha = (U8)(temp_color >> 24);
        info_color.r = (U8)(temp_color >> 16);
        info_color.g = (U8)(temp_color >> 8);
        info_color.b = (U8)temp_color;
        border_color.alpha = (U8)(temp_color >> 24);
        temp_color = ~temp_color;
        border_color.r = (U8)(temp_color >> 16);
        border_color.g = (U8)(temp_color >> 8);
        border_color.b = (U8)temp_color;
        gui_set_text_color(info_color);
        gui_set_text_border_color(border_color);

    }
#elif defined(__MMI_NCENTER_SUPPORT__)
    gui_set_text_color(UI_COLOR_WHITE);
    gui_set_text_border_color(UI_COLOR_BLACK);
#endif
    x = bar->x + STATUS_ICON_X_GAP;
    gdi_layer_push_clip();
    if(y_offset > 0)
    {
        gdi_layer_set_clip(bar->x1, bar->y1 + y_offset, bar->x2, bar->y1 + bar->height - 1);
    }
    else
    {
        gdi_layer_set_clip(bar->x1, 0, bar->x2, bar->y1 + y_offset + bar->height - 1);
    }
    gui_status_icon_bar_show_mainlcd_horizontal_background_oem_ex(bar->x1, bar->y1, bar->x2, bar->y2);
    if(bar->info_icon_type == WGUI_STATUS_ICON_BAR_ICON_TYPE_RESOURCE)
    {
        image_data = bar->info_icon_image;
        gui_measure_image(image_data, &w, &h);
        if(h > (bar->height - (STATUS_ICON_Y_GAP<<1)))
        {
            gdi_util_fit_box(
                GDI_UTIL_MODE_SHORT_SIDE_FIT,
                bar->height - (STATUS_ICON_Y_GAP<<1),
                bar->height - (STATUS_ICON_Y_GAP<<1),
                w,
                h,
                &icon_box_offset_x,
                &icon_box_offset_y,
                &resized_w,
                &resized_h);
                y = bar->y + y_offset + STATUS_ICON_Y_GAP + icon_box_offset_y;
                x += icon_box_offset_x;
                w = resized_w;
                h = resized_h;
        }
        else
        {
            y = bar->y + y_offset + (bar->height - h) / 2;
        }
        gdi_image_draw_resized_blend2layers(x, y, w, h, image_data);
    }
    else if(bar->info_icon_type == WGUI_STATUS_ICON_BAR_ICON_TYPE_FILE)
    {
        image_data = bar->info_icon_image;
        gdi_image_get_dimension_file((S8*)image_data, &w, &h);
        if(h > (bar->height - (STATUS_ICON_Y_GAP<<1)))
        {
            gdi_util_fit_box(
                GDI_UTIL_MODE_SHORT_SIDE_FIT,
                bar->height - (STATUS_ICON_Y_GAP<<1),
                bar->height - (STATUS_ICON_Y_GAP<<1),
                w,
                h,
                &icon_box_offset_x,
                &icon_box_offset_y,
                &resized_w,
                &resized_h);
            y = bar->y + y_offset + STATUS_ICON_Y_GAP + icon_box_offset_y;
            x += icon_box_offset_x;
            w = resized_w;
            h = resized_h;
        }
        else
        {
            y = bar->y + y_offset + (bar->height - h)/2;
        }
        gdi_image_draw_resized_file_blend2layers(
            x,
            y,
            w,
            h,
            image_data);
    }
    else if(bar->info_icon_type == WGUI_STATUS_ICON_BAR_ICON_TYPE_MEM)
    {
        image_data = bar->info_icon_image;
        image_type = bar->info_icon_format;
        if(image_type == 0)
        {
            image_type = gdi_image_get_type_from_mem((PS8)image_data);
        }
        /* if image_type is invalid, treat it as ab2 */
        if(image_type == GDI_IMAGE_TYPE_INVALID)
        {
            gdi_image_ab2_get_dimension_handler(
                        0, 
                        image_data, 
                        bar->info_icon_size, 
                        &w,
                        &h);
        }
        else
        {
            gdi_image_get_dimension_mem((U8)image_type, image_data, bar->info_icon_size, &w, &h);
        }
        if(h > (bar->height - (STATUS_ICON_Y_GAP<<1)))
        {
            gdi_util_fit_box(
                GDI_UTIL_MODE_SHORT_SIDE_FIT,
                bar->height - (STATUS_ICON_Y_GAP<<1),
                bar->height - (STATUS_ICON_Y_GAP<<1),
                w,
                h,
                &icon_box_offset_x,
                &icon_box_offset_y,
                &resized_w,
                &resized_h);
            y = bar->y + y_offset + STATUS_ICON_Y_GAP + icon_box_offset_y;
            x += icon_box_offset_x;
            w = resized_w;
            h = resized_h;
        }
        else
        {
            y = bar->y + y_offset + (bar->height - h)/2;
        }
        if(image_type == GDI_IMAGE_TYPE_INVALID)
        {
            gdi_image_ab2_draw_handler(
                    0,
                    0,
                    x,
                    y,
                    w,
                    h,
                    image_data,
                    bar->info_icon_size);
        }
        else
        {
            gdi_image_draw_resized_mem_blend2layers(
                x,
                y,
                w,
                h,
                image_data,
                image_type,
                bar->info_icon_size);
        }
    }
    x += w + STATUS_ICON_X_GAP; 
    gui_measure_string(bar->info_string, &w, &h);
    y = bar->y + y_offset + (bar->height - h) / 2;
    if (w > bar->x + bar->width - 1 - x - STATUS_ICON_X_GAP)
    {
        w = bar->x + bar->width - 1 - x - STATUS_ICON_X_GAP;
    }
    if (mmi_fe_get_r2l_state())
    {
        gui_print_truncated_borderd_text(x + w - 1, y, w, bar->info_string);
    }
    else
    {
        gui_print_truncated_borderd_text(x, y, w, bar->info_string);
    }
    gdi_layer_pop_clip();
}

#endif /* defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__) */

/*****************************************************************************
 * FUNCTION
 *  gui_status_icon_bar_show_oem
 * DESCRIPTION
 *  Show status icon bar
 * PARAMETERS
 *  bar       [IN]        Pointer to status icon bar struct
 * RETURNS
 *  void
 *****************************************************************************/
void gui_status_icon_bar_show_oem(gui_status_icon_bar_struct *bar)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    S32 i;
    S32 icon_id;
    S32 w = 0, h = 0;
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    S32 x, y;
#endif
    gui_status_icon_bar_element_struct *element;
#if (defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
    S32 y_offset;
#endif
#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    S32 j;
    S32 temp_color;
    color info_color;
    color border_color;
    stFontAttribute s_font={0,0,0,0x8F,0,1};
#endif
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT
    S32 cx1, cx2, cy1, cy2;
#endif
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
// baiwenlin 20130902  
#if defined(__OLED_BW_MMI__)
	return;
#endif /* __OLED_BW_MMI__ */
    gdi_layer_push_and_set_clip(bar->x1, bar->y1, bar->x2, bar->y2);
#if (defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
    if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_START_SHOW || bar->info_state == WGUI_STATUS_ICON_BAR_INFO_SHOW)
    {        
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT    
        wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_FALSE);    
#endif
        gui_status_icon_bar_show_info_oem(bar, 0);
       if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_START_SHOW)
        {
            gui_start_timer(bar->count, gui_status_icon_bar_info_hdlr);
            bar->info_state = WGUI_STATUS_ICON_BAR_INFO_SHOW;
            if (bar->info_callback)
            {
                bar->info_callback(bar->info_state, bar->param);
            }
        }
        gdi_layer_pop_clip();
        return;
    }
    else if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_HIDE || bar->info_state == WGUI_STATUS_ICON_BAR_EVENTS_HIDE)
    {
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT
        wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_TRUE);    
#endif
    }   
    else if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_FADE_IN)
    {        
        if (bar->fade_step == WGUI_STATUS_ICON_BAR_FADE_MAX_STEP)
        {
            gui_start_timer(WGUI_STATUS_ICON_BAR_FADE_COUNT, gui_status_icon_bar_fade_in_hdlr);
            bar->fade_step = 0;
            bar->info_state = WGUI_STATUS_ICON_BAR_INFO_START_SHOW;
            gdi_layer_pop_clip();
            return;
        }
    }
#endif /* defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__) */
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT
    if(WGUI_STATUS_ICON_BAR_UPDATE_ALL_EXCEPT_CLOCK == bar->update_type &&
        WGUI_STATUS_ICON_BAR_INVALID_ELEMENT_ID != wgui_status_icon_bar_clock_element_id)
    {
        gui_status_icon_bar_get_clip(bar,&cx1,&cy1,&cx2,&cy2);
        gui_status_icon_bar_set_clip(
            bar,
            cx1,
            cy1,
            cx1 + wgui_status_icon_bar_elements[wgui_status_icon_bar_clock_element_id].x - 1,
            cy2);
        gui_status_icon_bar_hide_oem(bar);
        gui_status_icon_bar_set_clip(
            bar,
            cx1 + wgui_status_icon_bar_elements[wgui_status_icon_bar_clock_element_id].x + wgui_status_icon_bar_elements[wgui_status_icon_bar_clock_element_id].width,
            cy1,
            cx2,
            cy2);
        gui_status_icon_bar_hide_oem(bar);
        gui_status_icon_bar_set_clip(bar, cx1, cy1, cx2, cy2);
    }
    else
#endif /* WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT */
    {
        gui_status_icon_bar_hide_oem(bar);
    }

#ifdef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
if(g_wgui_status_icon_bar_warning_mode)
{
    #ifdef __MMI_MAINLCD_480X800__
        gui_set_font(&s_font);
    #else
        gui_set_font(&MMI_small_font);
    #endif
    if (bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_STYLE || bar->flags & WGUI_STATUS_ICON_BAR_FLAG_BAR_SPECIAL_TRANSPARENT_STYLE ||
        bar->bar_id)
    {
        gui_set_text_color(UI_COLOR_WHITE);
        gui_set_text_border_color(UI_COLOR_BLACK);
    }
    else
    {
        temp_color = mmi_res_get_theme_color(WGUI_COL_STATUS_BAR_TEXT);
        info_color.alpha = (U8)(temp_color >> 24);
        info_color.r = (U8)(temp_color >> 16);
        info_color.g = (U8)(temp_color >> 8);
        info_color.b = (U8)temp_color;
        border_color.alpha = (U8)(temp_color >> 24);
        temp_color = ~temp_color;
        border_color.r = (U8)(temp_color >> 16);
        border_color.g = (U8)(temp_color >> 8);
        border_color.b = (U8)temp_color;
        gui_set_text_color(info_color);
        gui_set_text_border_color(border_color);

    }

    gui_measure_string(bar->warning_info_string, &w, &h);
    y = bar->y + (bar->height - h) / 2;
    if (w > bar->warning_info_w)
    {
        w = bar->warning_info_w;
    }
    if (mmi_fe_get_r2l_state())
    {
        gui_print_truncated_borderd_text(MMI_UI_STATUSBAR_GAP + w - 1, y, w, bar->warning_info_string);
    }
    else
    {
        gui_print_truncated_borderd_text(MMI_UI_STATUSBAR_GAP, y, w, bar->warning_info_string);
    }
    if(element_hide_icon)
    {
        wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].x = MMI_UI_STATUSBAR_GAP + w + STATUS_ICON_X_GAP;
        wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].y = (bar->height - wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].height)>>1;
        wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].flags |= GUI_STATUS_ICON_BAR_ICON_DISPLAY;
        gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE]); 
        wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].flags &= ~GUI_STATUS_ICON_BAR_ICON_DISPLAY;
        x = wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].x + wgui_status_icon_bar_icons[STATUS_ICON_LEFT_HIDE].width - 1 + STATUS_ICON_X_GAP;
    }
    else
    {
        x = MMI_UI_STATUSBAR_GAP + w + STATUS_ICON_X_GAP;
    }
    for (j = 0; j < bar->n_elements; j++)
    {
        element = &wgui_status_icon_bar_elements[bar->element_list[j]];
        if (element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_FLOAT)
        {
            element->x = x;
            x += element->width - 1 + STATUS_ICON_X_GAP;
        }
    }
} 
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */
    if (bar->icon_list != NULL)
    {
        for (i = 0; i < bar->n_icons; i++)
        {
            icon_id = bar->icon_list[i];
#if ((!defined(__MMI_FTE_SUPPORT__)) && defined(MMI_MAX_SIM_NUM) && (MMI_MAX_SIM_NUM >= 3))
            if (icon_id == STATUS_ICON_SIGNAL_STRENGTH)
            {
                #if !defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__)
                if (bar->n_signal == 0)
                {
                    gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH]);
                }
                else
                {
                    gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH + bar->n_signal + 1]);
                }
                #else
                gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_SIGNAL_STRENGTH]);
                #endif
                gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_BATTERY_STRENGTH]);
            }
            else if (icon_id >= STATUS_ICON_FULL_SMS && icon_id <= STATUS_ICON_SIM4_FULL_SMS)
            {
                if (wgui_status_icon_bar_icons[STATUS_ICON_FULL_SMS + bar->n_sms_full].flags & GUI_STATUS_ICON_BAR_ICON_BLINK)
                {
                    gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[STATUS_ICON_FULL_SMS + bar->n_sms_full]);
                }
            }
            else
            {
                gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[icon_id]);
            }            
#else
            gui_status_icon_bar_show_icon_oem(bar, &wgui_status_icon_bar_icons[icon_id]);
#endif
        }
    }

#ifdef WGUI_STATUS_ICON_SHOW_ELEMENT
    gdi_layer_lock_frame_buffer();
    if (bar->element_list != NULL)
    {
        for (i = 0; i < bar->n_elements; i++)
        {
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT
            if(WGUI_STATUS_ICON_BAR_UPDATE_ALL_EXCEPT_CLOCK == bar->update_type &&
               i == wgui_status_icon_bar_clock_element_id)
            {
                continue;
            }
#endif
            element = &wgui_status_icon_bar_elements[bar->element_list[i]];
            if (element->show && element->width > 0)
            {
#if(defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
                if ((element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_HIDE_WITH_NCENTER && (!(bar->info_state == WGUI_STATUS_ICON_BAR_EVENTS_HIDE || 
                    (bar->info_state != WGUI_STATUS_ICON_BAR_INFO_HIDE && bar->info_state != WGUI_STATUS_ICON_BAR_EVENTS_HIDE && 
                    bar->previous_state == WGUI_STATUS_ICON_BAR_EVENTS_HIDE)))) || !(element->flag & WGUI_STATUS_ICON_BAR_ELEMENT_HIDE_WITH_NCENTER))
#endif
                {
                    element->show(
                        bar->x + element->x,
                        bar->y + element->y,
                        bar->x + element->x + element->width - 1,
                        bar->y + element->y + element->height - 1);
                }
            }
        }
    }
    gdi_layer_unlock_frame_buffer();
#endif
    bar->update_type = WGUI_STATUS_ICON_BAR_UPDATE_AUTO;

#ifndef __MMI_STATUS_ICONBAR_COSMOS_STYLE__
    if(g_wgui_status_icon_bar_warning_mode)
    { 
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT    
        wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_FALSE);    
#endif
        gui_status_icon_bar_hide_oem(bar);
        gui_set_font(&MMI_small_font);
        gui_set_text_color(UI_COLOR_WHITE);
        gui_set_text_border_color(UI_COLOR_BLACK);   
        gui_measure_string(bar->warning_info_string, &w, &h);
        if (mmi_fe_get_r2l_state())
        {
            gui_print_truncated_borderd_text(MAIN_LCD_DEVICE_WIDTH - MMI_UI_STATUSBAR_GAP - 2, bar->y + (bar->height - h) / 2, MAIN_LCD_DEVICE_WIDTH - MMI_UI_STATUSBAR_GAP - MMI_UI_STATUSBAR_GAP - 2, bar->warning_info_string);
        }
        else
        {
            gui_print_truncated_borderd_text(MMI_UI_STATUSBAR_GAP + 1, bar->y + (bar->height - h) / 2, MAIN_LCD_DEVICE_WIDTH - MMI_UI_STATUSBAR_GAP - MMI_UI_STATUSBAR_GAP - 2, bar->warning_info_string);
        }
    }
    else
    {
#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT    
        wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_TRUE);    
#endif  
    }
#endif /* __MMI_STATUS_ICONBAR_COSMOS_STYLE__ */

#if (defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__))
    if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_FADE_OUT)
    {        
        if (bar->fade_step == WGUI_STATUS_ICON_BAR_FADE_MAX_STEP)
        {
            bar->info_state = bar->previous_state;
            bar->fade_step = 0;
            if (bar->info_callback)
            {
                bar->info_callback(WGUI_STATUS_ICON_BAR_INFO_HIDE, bar->param);
            }
        }
        else
        {
            y_offset = (bar->height)/WGUI_STATUS_ICON_BAR_FADE_MAX_STEP * (bar->fade_step);

#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT         
            wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_FALSE);    
#endif
            gui_status_icon_bar_show_info_oem(bar,y_offset);
            gui_start_timer(WGUI_STATUS_ICON_BAR_FADE_COUNT, gui_status_icon_bar_fade_out_hdlr);
        }
    }
    else if (bar->info_state == WGUI_STATUS_ICON_BAR_INFO_FADE_IN)
    {    
        gui_start_timer(WGUI_STATUS_ICON_BAR_FADE_COUNT, gui_status_icon_bar_fade_in_hdlr);
        y_offset = ((bar->height)/WGUI_STATUS_ICON_BAR_FADE_MAX_STEP * (bar->fade_step + 1)) - bar->height;

#ifdef WGUI_STATUS_ICON_SHOW_TIME_IN_RIGHT
        wgui_clock_enable_update(wgui_status_icon_bar_clock_element_id, MMI_FALSE);    
#endif
        gui_status_icon_bar_show_info_oem(bar, y_offset);
    }
#endif /* defined(__MMI_STATUS_ICONBAR_COSMOS_STYLE__) || defined(__MMI_NCENTER_SUPPORT__) */
    gdi_layer_pop_clip();
}


